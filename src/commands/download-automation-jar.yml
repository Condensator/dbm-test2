description: >
  Ensure environment has DBmaestroAgent.jar
  If not - download it

parameters:
  tool_path:
    type: string
    default: "~/usr/local/tools/dbmaestro"
    description: "Path where the DBmaestroAgent.jar is located"
steps:
  - restore_cache:
      keys:
        - dbmaestro-automation-jar-{{ checksum "DBmaestroAgent.jar" }}
  - run:
      environment:
        PARAM_DBM_TOOL_PATH: << parameters.tool_path >>
      name: Download Agent
      command: <<include(scripts/download-agent.sh)>>
  - save_cache:
      paths:
        - << parameters.tool_path >>  # default location
      key: dbmaestro-automation-jar-{{ checksum "DBmaestroAgent.jar" }}
